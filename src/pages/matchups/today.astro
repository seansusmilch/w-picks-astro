---
import Layout from '@/layouts/Layout.astro';
import Matchup from '@/components/Matchup/Matchup.astro';
import { Button } from '@/components/ui/button';
import MatchupsList from '@/components/Matchup/MatchupsList.astro';

const pb = Astro.locals.pb;

const today = new Date();
const todayStart = new Date(today.setHours(0, 0, 0, 0));
const todayEnd = new Date(today.setHours(23, 59, 59, 999));

let matchups = [];
const matchupsRes = await pb.collection('matchups').getList(1, 30, {
  filter: pb.filter('time_utc >= {:start} && time_utc <= {:end}', {
    start: todayStart,
    end: todayEnd,
  }),
  sort: 'time_utc',
});
matchups = matchupsRes.items;
---

<Layout title='W Picks | Today'>
  <h1 class='text-4xl font-bold'>Today's Matchups</h1>
  <div class='grid grid-cols-1 gap-2 max-w-md'>
    {
      matchups.length ? (
        <MatchupsList matchups={matchups} />
      ) : (
        <>
          <p class='py-8'>No matchups today</p>
          <a href='/matchups'>
            <Button className='w-full'>View all matchups</Button>
          </a>
        </>
      )
    }
  </div>
</Layout>
